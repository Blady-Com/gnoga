<!doctype HTML>
<HTML>
   <HEAD>
      <meta http-equiv="Pragma" content="no-cache">
      <meta http-equiv="Expires" content="-1">
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <script src="/js/jquery.min.js"></script>
   </HEAD>
<BODY>
</BODY>
<noscript>Your browser must support JavaScript and be HTML 5 compilant to see this site.</noscript>
<script>
  var ws;
  var adr;
  var reconnects=0;
  var params={};
  var gnoga={};

  function Setup_ws() {
        reconnects++;
        ws.onmessage = function (event) {
           reconnects = 0;
           try {
              console.log ("eval data = " + event.data);
              eval (event.data);
           } catch (e) {
              console.error (e.message);
           }
        }
        ws.onerror = function (event) {
           if (gnoga['Connection_ID'] == 'undefined') {
              location.reload(true);
           }

           if (reconnects < 2) {
              console.log ("onerror: reconnect " + reconnects);
              ws.onclose=null;
              ws = new WebSocket (adr  + "?Old_ID=" + gnoga['Connection_ID']);
              setTimeout (Setup_ws, 100);
           } else {
              if (gnoga['html_on_close'] != "") {
                 $(document.body).html(gnoga['html_on_close']);
              } else {
                 alert ("Server connection lost " + event.reason);
              }
           }
        }
        ws.onclose = function (event) {
           if (gnoga['html_on_close'] != "") {
             $(document.body).html(gnoga['html_on_close']);
           } else {
             alert ("Server connection lost " + event.reason);
           }
        }
  }

  $( document ).ready(function() {
     var s = document.location.search;
     var tokens;
     var r = /[?&]?([^=]+)=([^&]*)/g;

     s = s.split("+").join(" ");

     while (tokens = r.exec(s)) {
        params[decodeURIComponent(tokens[1])]
           = decodeURIComponent(tokens[2]);
     }

     adr = "ws://" + location.hostname;
     if (location.port != "") { adr = adr + ":" + location.port; }
     adr = adr + "/gnoga";

     ws = new WebSocket (adr);

     if (ws != null) {
        Setup_ws();
     } else {
        document.writeln ("If you are seeing this your browser or your connection to the internet is blocking websockets.");
     }
  });
</script>
<!--@@data.push_params@@-->
</HTML>
